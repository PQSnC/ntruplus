#include "params.h"
#include "reduce.h"
#include "ntt.h"

const int16_t zetas[144] = {
	 -147, -1033, -1265,   708,   460,  1265,  -467,   727,
	  556,  1307,  -773,  -161,  1200, -1612,   570,  1529,
	 1135,  -556,  1120,   298,  -822, -1556,   -93,  1463,
	  532,  -377,  -909,    58,  -392,  -450,  1722,  1236,
	 -486,  -491, -1569, -1078,    36,  1289, -1443,  1628,
	 1664,  -725,  -952,    99, -1020,   353,  -599,  1119,
	  592,   839,  1622,   652,  1244,  -783, -1085,  -726,
	  566,  -284, -1369, -1292,   268,  -391,   781,  -172,
	   96, -1172,   211,   737,   473,  -445,  -234,   264,
	-1536,  1467,  -676, -1542,  -170,   635,  -705, -1332,
	 -658,   831, -1712,  1311,  1488,  -881,  1087, -1315,
	 1245,   -75,   791,    -6,  -875,  -697,   -70, -1162,
	  287,  -767,  -945,  1598,  -882,  1261,   206,   654,
	-1421,   -81,   716, -1251,   838, -1300,  1035,  -104,
	  966,  -558,   -61, -1704,   404,  -899,   862, -1593,
	-1460,   -37,  1266,   965, -1584, -1404,  -265,  -942,
	  905,  1195,  -619,   787,   118,   576,   286, -1475,
	 -194,   928,  1229, -1032,  1608,  1111, -1669,   642
};

const int32_t zetas_asm[144] = {
	3397956481, 2406523475, 1396454510, 1077158417,
	1888443822,  559078763, 2477340119, 1339304237,
	 660955338, 2139408066, 3273716756, 1129339101,
	  72059041, 2361797174, 1535603002,  370234381,
	2955663060,  195056369, 3856401067, 3027722101,
	 100634178, 2529520803, 1554238961,  889556432,
	 903222802, 2904724773, 3550771343, 2309616490,
	3120901894,  356568011, 3342048605,  708166433,
	3112205114,  122997328, 3482439494,  255933834,
	3199172921, 1566662934, 4162030791, 3484924289,
	2015168341, 1915776561, 3455106755, 2386645119,
	1822596767, 1490876701,  972797048, 1545542180,
	1654873139, 3419077235, 4083759764,  788922255,
	1623813207,  735499173, 1042371294, 2666184501,
	2167983203, 3477469905, 1032432116,  200025958,
	 900738007, 2067349026, 1633752385, 1350485812,
	1848687110, 3200415319, 1610146838,   44726302,
	1601450057,    7454384,  982736226, 1546784578,
	4201787503, 1410120880, 2502188064, 2022622725,
	1443665606, 4207999489, 3207869702, 3429016413,
	2395341900,  213692328,  970312253, 2914663951,
	1997774780, 3497348261, 2221406285, 1434968825,
	1456089578,  119270137, 1832535945,  355325614,
	 146602876,  715620817, 3334594222,  332962464,
	3809189971, 1282153963, 1526906222, 4053942230,
	1152944649, 1212579717,  552866777,  587653900,
	 129209315, 1285881155, 1041128897, 2679850870,
	 690772872, 3966974422, 4004246340, 2117044916,
	4219181064, 1200155745, 3601709631, 3773160451,
	 262145820,  915646774, 1979138821, 1070946431,
	 501928490, 3178052168, 3714767780, 1605177249,
	2594125460, 3096053949, 1572874920, 2481067310,
	4248998598, 2292222928, 2946966279, 3392986892,
	1170338211, 3965732025, 2327010051, 2550641556,
	2872422444,  703196844, 3942126477, 3317200660,
	3525923398, 1124369512, 1484664715, 0
};

const int32_t zetas_inv_asm[144] = {
	2810302582, 3170597785,  769043899,  977766637,
	 352840820, 3591770453, 1422544853, 1744325741,
	1967957246,  329235272, 3124629086,  901980405,
	1348001018, 2002744369,   45968699, 1813899987,
	2722092377, 1198913348, 1700841837, 2689790048,
	 580199517, 1116915129, 3793038807, 3224020866,
	2315828476, 3379320523, 4032821477,  521806846,
	 693257666, 3094811552,   75786233, 2177922381,
	 290720957,  327992875, 3604194425, 1615116427,
	3253838400, 3009086142, 4165757982, 3707313397,
	3742100520, 3082387580, 3142022648,  241025067,
	2768061075, 3012813334,  485777326, 3962004833,
	 960373075, 3579346480, 4148364421, 3939641683,
	2462431352, 4175697160, 2838877719, 2859998472,
	2073561012,  797619036, 2297192517, 1380303346,
	3324655044, 4081274969, 1899625397,  865950884,
	1087097595,   86967808, 2851301691, 2272344572,
	1792779233, 2884846417,   93179794, 2748182719,
	3312231071, 4287512913, 2693517240, 4250240995,
	2684820459, 1094551978, 2446280187, 2944481485,
	2661214912, 2227618271, 3394229290, 4094941339,
	3262535181,  817497392, 2126984094, 1628782796,
	3252596003, 3559468124, 2671154090, 3506045042,
	 211207533,  875890062, 2640094158, 2749425117,
	3322170249, 2804090596, 2472370530, 1908322178,
	 839860542, 2379190736, 2279798956,  810043008,
	 132936506, 2728304363, 1095794376, 4039033463,
	 812527803, 4171969969, 1182762183, 3586800864,
	 952918692, 3938399286, 1174065403, 1985350807,
	 744195954, 1390242524, 3391744495, 3405410865,
	2740728336, 1765446494, 4194333119, 1267245196,
	 438566230, 4099910928, 1021250541, 1949321287,
	 115542945, 2155559231, 3634011959, 3735888534,
	 319296094,  454717394, 2759364295, 3924732916,
	 610017051, 3165628196, 4222908256, 4179424352,
	2343161216, 3975671203,  898253213, 0
};

extern void ntt_fast(int16_t *, const int32_t *);
/*************************************************
* Name:        ntt
*
* Description: number-theoretic transform (NTT) in Rq.
*
* Arguments:   - int16_t r[NTRUPLUS_N]: pointer to input/output vector of elements of Zq
**************************************************/
void ntt(int16_t r[NTRUPLUS_N])
{
	ntt_fast(r, zetas_asm);
}

extern void invntt_fast(int16_t *, const int32_t *);
/*************************************************
* Name:        invntt
*
* Description: inverse number-theoretic transform in Rq and
*              multiplication by Montgomery factor R = 2^16.
*
* Arguments:   - int16_t r[NTRUPLUS_N]: pointer to output vector of elements of Zq
*              - int16_t a[NTRUPLUS_N]: pointer to input vector of elements of Zq
**************************************************/
void invntt(int16_t r[NTRUPLUS_N])
{
	invntt_fast(r, zetas_inv_asm);
}
